<!-- TaskList template
		 - Top form collects a title (required) and optional description.
		 - Uses ngModel for two-way binding to `newTitle` and `newDescription`.
		 - The form's (ngSubmit) calls addTask() defined in the component.
		 - Each task in `tasks` is rendered using the existing <app-task-item>
			 component so the display format matches the task-item component.
-->
<button class="btn-demo" (click)="generateContentForDemoPurposes()">Load Demo Data</button>

<section class="task-list-wrapper">
	<!-- task-list-card: visually separates the TaskList from surrounding page
			 content for emphasis (shadow, rounded corners). -->

	<div class="task-list-card">
		<!-- Header: title + subtitle help orient the user and distinguish the area -->
		<!-- Demo button positioned in top right corner -->
		
		<header class="task-list-header">
			<h2 class="task-list-title">Your Tasks</h2>
			<p class="task-list-subtitle">Add, complete, and remove tasks below.</p>
		</header>

		<!-- Form: title required, description optional -->
		<!-- Add legacy class `add-task-form` so global styles target this form -->
		<form class="task-form add-task-form" (ngSubmit)="addTask()">
		<div class="form-row">
			<!-- name attributes are needed for ngModel inside forms -->
			<label class="sr-only" for="newTitleInput">Task title</label>
			<input id="newTitleInput" name="title" class="task-input" [(ngModel)]="newTitle" placeholder="Task title" required maxlength="50" />
			<div class="char-counter">{{ (newTitle || '').length }}/50</div>
			<!-- Add legacy `add-button` class so the button uses original styling -->
			<button class="btn-add add-button" type="submit">Add</button>
		</div>

		<div class="form-row">
			<!-- Give textarea the legacy `.task-description` class as well -->
			<textarea name="description" class="task-textarea task-description" [(ngModel)]="newDescription" placeholder="Optional description" maxlength="250"></textarea>
			<div class="char-counter">{{ (newDescription || '').length }}/250</div>
		</div>
		<!-- New: due date input for the new task (ISO date) -->
		<div class="form-row">
			<label class="due-label">Due:</label>
			<input type="date" name="dueDate" class="task-due" [(ngModel)]="newDueDate" aria-label="'Due date for new task: ' + newTitle" />
		</div>
	</form>

		<!-- Tasks list -->
		<!-- Give the list the legacy `.task-list` class so global styles apply -->
		<ul class="tasks task-list">
		<li *ngFor="let task of tasks" class="task-row" [class.overdue-row]="isTaskOverdue(task)" [id]="getOverdueRowId(task)">
			<!-- checkbox toggles completed state -->
			<label class="task-meta">
				<input type="checkbox" [checked]="task.completed" (change)="toggleComplete(task)" [attr.aria-label]="'Toggle completion for task: ' + task.title" />
				<span class="sr-only">Mark task as {{ task.completed ? 'incomplete' : 'complete' }}</span>
			</label>

			<!-- Edit mode: show edit form -->
			<div *ngIf="isEditing(task)" class="task-item edit-mode">
				<form class="task-form edit-task-form" (ngSubmit)="saveEdit()">
					<div class="form-row">
						<label class="sr-only" for="editTitleInput">Task title</label>
						<input id="editTitleInput" name="editTitle" class="task-input" [(ngModel)]="editTitle" placeholder="Task title" required maxlength="50" />
						<div class="char-counter">{{ (editTitle || '').length }}/50</div>
					</div>
					<div class="form-row">
						<textarea name="editDescription" class="task-textarea" [(ngModel)]="editDescription" placeholder="Task description" maxlength="250"></textarea>
						<div class="char-counter">{{ (editDescription || '').length }}/250</div>
					</div>
					<!-- Allow editing the due date only in edit mode -->
					<div class="form-row">
						<label class="due-label">Due:</label>
						<input type="date" name="editDueDate" class="task-due" [(ngModel)]="editDueDate" aria-label="'Due date for task: ' + editTitle" />
					</div>
					<div class="edit-actions">
						<button class="btn-save" type="submit">Save</button>
						<button class="btn-cancel" type="button" (click)="cancelEdit()">Cancel</button>
					</div>
				</form>
			</div>

			<!-- Display mode: show task content -->
			<div *ngIf="!isEditing(task)" class="task-item">
				<app-task-item [task]="task"></app-task-item>
				<!-- Show due date (if present). Editing the due date requires entering
					 edit mode using the pencil button. -->
				<div class="task-due-row">
					<span class="task-due-display" *ngIf="task.dueDate">Due: {{ task.dueDate }}</span>
				</div>
			</div>

			<!-- Action buttons (edit, remove) -->
			<div class="task-actions">
				<button *ngIf="!isEditing(task)" class="btn-edit" (click)="startEdit(task)">✏️</button>
				<button class="btn-remove" (click)="remove(task)">×</button>
			</div>
		</li>
				</ul>
			</div>
		</section>
