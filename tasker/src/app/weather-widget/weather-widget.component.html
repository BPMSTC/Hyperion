<div class="weather-widget" *ngIf="weather">
  <div class="weather-header">
    <span class="weather-icon">{{ getWeatherIcon() }}</span>
    <div class="weather-info">
      <div class="weather-temp">{{ weather.temperature }}Â°F</div>
      <div class="weather-desc">{{ weather.weatherDescription }}</div>
      <div class="weather-location" *ngIf="currentLocation">ğŸ“ {{ currentLocation }}</div>
    </div>
    <div class="weather-controls">
      <button class="weather-refresh" (click)="refreshWeather()" title="Refresh weather">
        ğŸ”„
      </button>
      <button class="weather-location-btn" (click)="toggleLocationInput()" title="Change location">
        ğŸ“
      </button>
    </div>
  </div>

  <!-- Location input panel -->
  <div class="location-input-panel" *ngIf="showLocationInput">
    <form (ngSubmit)="searchLocation()" class="location-form">
      <input 
        type="text" 
        [(ngModel)]="locationQuery"
        name="location"
        placeholder="Enter city or ZIP code"
        class="location-input"
        [disabled]="searching"
      />
      <button type="submit" class="location-search-btn" [disabled]="searching || !locationQuery.trim()">
        {{ searching ? 'ğŸ”...' : 'ğŸ” Search' }}
      </button>
      <button type="button" class="location-auto-btn" (click)="useAutoLocation()" [disabled]="searching">
        ğŸ“ Use My Location
      </button>
    </form>
    <div class="location-error" *ngIf="locationError">
      {{ locationError }}
    </div>
  </div>
  
  <div class="weather-details">
    <span class="weather-detail">ğŸ’¨ {{ weather.windSpeed }} mph</span>
  </div>

  <div class="task-suggestions" *ngIf="showSuggestions">
    <div class="suggestions-header">
      <strong>Suggested tasks for today:</strong>
      <button class="toggle-suggestions" (click)="showSuggestions = !showSuggestions">
        â–¼
      </button>
    </div>
    <ul class="suggestions-list">
      <li *ngFor="let suggestion of taskSuggestions">{{ suggestion }}</li>
    </ul>
  </div>

  <div class="task-suggestions collapsed" *ngIf="!showSuggestions">
    <button class="toggle-suggestions-expand" (click)="showSuggestions = true">
      Suggested tasks â–¶
    </button>
  </div>
</div>

<div class="weather-widget loading" *ngIf="loading">
  <div class="weather-loading">Loading weather...</div>
</div>

<div class="weather-widget error" *ngIf="error && !loading">
  <div class="weather-error">
    Unable to load weather. 
    <button (click)="refreshWeather()">Retry</button>
  </div>
</div>